(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    130048,       2939]
NotebookOptionsPosition[    129694,       2925]
NotebookOutlinePosition[    130090,       2941]
CellTagsIndexPosition[    130047,       2938]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"PairsIndices", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"BoundaryList", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"NonBoundaryList", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"bwVert", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"rholist", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"CornerVert", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"OrigLine", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"DualLine", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"FirstSecondVerts", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"AdjList", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"DualList", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"OrigList", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"PairToCrossingVerts", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"AdjToInfty", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"AdjToAdjToInftyList", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"KitePairs", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"Face2VertexList", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{
     "ReadLine", "[", 
      "\"\<C:\\\\Users\\\\14846\\\\Desktop\\\\MATHEMATICA_FORMAT.txt\>\"", 
      "]"}]}], ";", "\n", 
    RowBox[{"Vertex2FaceList", "=", 
     RowBox[{"ToExpression", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"RhoIndex2VertexDict", "=", 
     RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", " ", 
      RowBox[{"i", "<", 
       RowBox[{
        RowBox[{"Length", "[", "bwVert", "]"}], "+", "1"}]}], ",", " ", 
      RowBox[{"i", "++"}], ",", " ", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{"RhoIndex2VertexDict", ",", " ", 
        RowBox[{"i", "\[Rule]", 
         RowBox[{"bwVert", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AdjDict", "=", 
     RowBox[{"<|", " ", "|>"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"Length", "[", "AdjList", "]"}]}], ",", 
      RowBox[{"i", "+=", "2"}], ",", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{"AdjDict", ",", " ", 
        RowBox[{
         RowBox[{"AdjList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
         RowBox[{"AdjList", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"PairToCVDict", "=", 
     RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"Length", "[", "PairToCrossingVerts", "]"}]}], ",", 
      RowBox[{"i", "+=", "2"}], ",", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{"PairToCVDict", ",", " ", 
        RowBox[{
         RowBox[{"PairToCrossingVerts", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
         RowBox[{"PairToCrossingVerts", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"AdjToAdjToInftyDict", "=", 
     RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"Length", "[", "AdjToAdjToInftyList", "]"}]}], ",", 
      RowBox[{"i", "+=", "2"}], ",", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{"AdjToAdjToInftyDict", ",", " ", 
        RowBox[{
         RowBox[{"AdjToAdjToInftyList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
         RowBox[{"AdjToAdjToInftyList", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Vertex2FaceDict", "=", 
     RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"Length", "[", "Vertex2FaceList", "]"}]}], ",", 
      RowBox[{"i", "+=", "2"}], ",", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{"Vertex2FaceDict", ",", " ", 
        RowBox[{
         RowBox[{"Vertex2FaceList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
         RowBox[{"Vertex2FaceList", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Face2VertexDict", "=", 
     RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{"Length", "[", "Face2VertexList", "]"}]}], ",", 
      RowBox[{"i", "+=", "2"}], ",", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{"Face2VertexDict", ",", " ", 
        RowBox[{
         RowBox[{"Face2VertexList", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
         RowBox[{"Face2VertexList", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"rho", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       SubscriptBox["r", "i"], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "rholist", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"F", "[", "x_", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"PolyLog", "[", 
         RowBox[{"2", ",", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", 
           SuperscriptBox["\[ExponentialE]", "x"]}]}], "]"}], "-", 
        RowBox[{"PolyLog", "[", 
         RowBox[{"2", ",", 
          RowBox[{"\[ImaginaryI]", " ", 
           SuperscriptBox["\[ExponentialE]", "x"]}]}], "]"}]}], ")"}]}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"G", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"F", "[", 
       RowBox[{"a", "-", "b"}], "]"}], "+", 
      RowBox[{"F", "[", 
       RowBox[{"b", "-", "a"}], "]"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Pi]", "/", "2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"a", "+", "b"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"BSNew", "=", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"G", "[", 
         RowBox[{
          SubscriptBox["r", 
           RowBox[{
            RowBox[{"PairsIndices", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]], ",", " ", 
          SubscriptBox["r", 
           RowBox[{
            RowBox[{"PairsIndices", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "PairsIndices", "]"}]}], "}"}]}], "]"}], " ",
       "+", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["r", "v"], "*", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"BoundaryList", ",", " ", "v"}], "]"}], ",", " ", "Pi", 
           ",", " ", 
           RowBox[{"2", "*", "Pi"}]}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"v", ",", " ", "1", ",", " ", 
          RowBox[{"Length", "[", "rho", "]"}]}], "}"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"NM", "=", 
     RowBox[{"NMinimize", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Re", "[", "BSNew", "]"}], ",", " ", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            SubscriptBox["r", "j"], ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", "1", ",", " ", 
              RowBox[{"Length", "[", "rho", "]"}]}], "}"}]}], "]"}], 
          "\[Equal]", "0"}]}], "}"}], ",", "rho", ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "35"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "35"}], ",", 
       RowBox[{"WorkingPrecision", "\[Rule]", "45"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"RADII", "=", 
     RowBox[{"Exp", "[", 
      RowBox[{"Re", "[", 
       RowBox[{"rho", "/.", 
        RowBox[{"(", 
         RowBox[{"NM", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ")"}]}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"RADII", " ", "=", " ", 
     RowBox[{"RADII", "/", 
      RowBox[{"RADII", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"normalize", " ", "r1"}], " ", "\[Rule]", " ", "1"}], ",", " ", 
      RowBox[{"and", " ", "drop", " ", "some", " ", "decimals", " ", 
       RowBox[{"(", 
        RowBox[{"inaccurate", "?"}], ")"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"radii", "=", 
     RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", 
       RowBox[{"Length", "[", "rho", "]"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{"radii", ",", " ", 
        RowBox[{
         RowBox[{"Lookup", "[", 
          RowBox[{"RhoIndex2VertexDict", ",", " ", "i"}], "]"}], "->", 
         RowBox[{"RADII", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], "]"}], ";", " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"SendToInt", "[", 
       RowBox[{"\[Epsilon]_", ":", "0"}], "]"}], "[", "x_", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"x", "-", 
          RowBox[{"Floor", "[", "x", "]"}]}], "]"}], "<", "\[Epsilon]"}], " ",
        ",", 
       RowBox[{"Floor", "[", "x", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x", "-", 
            RowBox[{"Ceiling", "[", "x", "]"}]}], "]"}], "<", "\[Epsilon]"}], 
         " ", ",", 
         RowBox[{"Ceiling", "[", "x", "]"}], ",", "x"}], "]"}], ",", "x"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getCartesian", "[", "invCoordList_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "bz1", ",", " ", "bz2", ",", " ", "b", ",", " ", "z2", ",", " ", 
         "z1"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bz1", "=", 
         RowBox[{"invCoordList", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bz2", "=", " ", 
         RowBox[{"invCoordList", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", " ", "=", " ", 
         RowBox[{"invCoordList", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"z1", "=", 
         RowBox[{"bz1", "/", "b"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"z2", " ", "=", 
         RowBox[{"bz2", "/", "b"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"z1", ",", " ", "z2"}], "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getCartesianAndRad", "[", "invCoordList_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "bz1", ",", " ", "bz2", ",", " ", "b", ",", " ", "z2", ",", " ", 
         "z1"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bz1", "=", 
         RowBox[{"invCoordList", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bz2", "=", " ", 
         RowBox[{"invCoordList", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"b", " ", "=", " ", 
         RowBox[{"invCoordList", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"z1", "=", 
         RowBox[{"bz1", "/", "b"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"z2", " ", "=", 
         RowBox[{"bz2", "/", "b"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"z1", ",", " ", "z2"}], "}"}], ",", " ", 
          RowBox[{"1", "/", "b"}]}], "}"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getRemainingKiteVertex", "[", 
      RowBox[{"vertex1_", ",", " ", "vertex2_", ",", " ", "vertex3_"}], "]"}],
      ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"vert1", "=", "vertex1"}], ",", " ", 
         RowBox[{"vert2", "=", "vertex2"}], ",", " ", 
         RowBox[{"vert3", "=", "vertex3"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"list1", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"Vertex2FaceDict", ",", " ", "vert1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"list2", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"Vertex2FaceDict", ",", " ", "vert2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"list3", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"Vertex2FaceDict", ",", " ", "vert3"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"commonlist", "=", 
         RowBox[{"Intersection", "[", 
          RowBox[{"list1", ",", "list2", ",", "list3"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexSet", "=", 
         RowBox[{"Lookup", "[", 
          RowBox[{"Face2VertexDict", ",", " ", 
           RowBox[{"commonlist", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexSet", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"VertexSet", ",", " ", "vert1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexSet", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"VertexSet", ",", " ", "vert2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexSet", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"VertexSet", ",", " ", "vert3"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"VertexSet", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "*", " ", "This", " ", "function", " ", "reflects", " ", "a", " ", 
      "point", " ", "over", " ", "a", " ", "line", " ", "defined", " ", "by", 
      " ", "two", " ", "points"}], " ", "**)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"reflection", "[", 
      RowBox[{
      "PointToReflect_", ",", " ", "Point1OfLineToReflectOver_", ",", " ", 
       "Point2OfLineToReflectOver_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p", "=", "PointToReflect"}], ",", " ", 
         RowBox[{"lp1", "=", "Point1OfLineToReflectOver"}], ",", " ", 
         RowBox[{"lp2", "=", "Point2OfLineToReflectOver"}], ",", " ", "x1", 
         ",", " ", "x2", ",", " ", "y1", ",", " ", "y2", ",", " ", "slope", 
         ",", " ", "deltax", ",", " ", "deltay"}], "}"}], ",", " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"x1", "=", 
         RowBox[{"lp1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"x2", "=", 
         RowBox[{"lp2", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"y1", "=", 
         RowBox[{"lp1", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"y2", "=", 
         RowBox[{"lp2", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", " ", 
         RowBox[{"(*", 
          RowBox[{
          "*", " ", "IF", " ", "the", " ", "line", " ", "is", " ", "NOT", " ",
            "vertical"}], " ", "**)"}], " ", 
         RowBox[{
          RowBox[{"x1", "\[NotEqual]", "x2"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"(*", 
            RowBox[{
            "*", " ", "AND", " ", "IF", " ", "the", " ", "line", " ", "is", 
             " ", "NOT", " ", "horizontal"}], " ", "**)"}], " ", 
           RowBox[{
            RowBox[{"y1", "\[NotEqual]", "y2"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"slope", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y2", "-", "y1"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"x2", "-", "x1"}], ")"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"orthogonalSlope", "=", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "slope"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"normalVectorToLine", "=", 
              RowBox[{"{", 
               RowBox[{"1", ",", " ", "orthogonalSlope"}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"rt", "=", 
              RowBox[{"ReflectionTransform", "[", 
               RowBox[{"normalVectorToLine", ",", "lp1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"answer", "=", 
              RowBox[{"rt", "[", "p", "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "*", " ", "ELSE", " ", "the", " ", "line", " ", "is", " ", 
               "not", " ", "vertical"}], ",", " ", 
              RowBox[{"but", " ", "horizontal"}], ",", " ", 
              RowBox[{"so", " ", "compute", " ", "this"}]}], " ", "**)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"deltay", "=", 
              RowBox[{"2", "*", 
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", "y1"}], "]"}]}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"answer", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "+", "deltay"}]}], 
               "}"}]}]}], ",", " ", 
            RowBox[{"(*", 
             RowBox[{
             "*", " ", "ELSE", " ", "the", " ", "line", " ", "is", " ", 
              "vertical", " ", "so", " ", "compute", " ", "this"}], " ", 
             "**)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"deltax", "=", " ", 
              RowBox[{"2", "*", 
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", "x1"}], "]"}]}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"answer", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "+", "deltax"}], ",", " ", 
                RowBox[{"p", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
        " ", "answer"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Q", "=", 
     RowBox[{"(", GridBox[{
        {"0", 
         RowBox[{"1", "/", "2"}], "0", "0"},
        {
         RowBox[{"1", "/", "2"}], "0", "0", "0"},
        {"0", "0", 
         RowBox[{"-", "1"}], "0"},
        {"0", "0", "0", 
         RowBox[{"-", "1"}]}
       }], ")"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"InvCoordDict", "=", 
     RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AssociateTo", "[", 
     RowBox[{"InvCoordDict", ",", " ", 
      RowBox[{"OrigLine", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", "0", ",", " ", 
         RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], ";", "\n", 
    RowBox[{"AssociateTo", "[", 
     RowBox[{"InvCoordDict", ",", " ", 
      RowBox[{"DualLine", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", 
         RowBox[{"-", "1"}], ",", " ", "0"}], "}"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"FirstSecondVerts", "=", 
     RowBox[{"Lookup", "[", 
      RowBox[{"AdjDict", ",", "CornerVert"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"CVDone", "=", 
     RowBox[{"{", "CornerVert", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"CoordKnown", "=", 
     RowBox[{"{", 
      RowBox[{"OrigLine", ",", " ", "DualLine"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"*", " ", "For", " ", "each", " ", "vertex", " ", "in", " ", 
       RowBox[{"FirstSecondVerts", "--"}], "These", " ", "are", " ", "the", 
       " ", "vertices", " ", "adjacent", " ", "to", " ", "CornerVert"}], ",", 
      " ", 
      RowBox[{
      "and", " ", "the", " ", "centers", " ", "of", " ", "the", " ", "first", 
       " ", "circles", " ", "we", " ", "are", " ", "placing"}]}], " ", 
     "**)"}], "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{
        RowBox[{"Length", "[", "FirstSecondVerts", "]"}], "+", "1"}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"coor", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", " ", "y", ",", " ", "z", ",", " ", "w"}], "}"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"eq1", "=", 
        RowBox[{
         RowBox[{"coor", ".", "Q", ".", "coor"}], " ", "\[Equal]", " ", 
         RowBox[{"-", "1"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eq2", " ", "=", " ", 
        RowBox[{"y", "\[Equal]", 
         RowBox[{"1", "/", 
          RowBox[{"Lookup", "[", 
           RowBox[{"radii", ",", " ", 
            RowBox[{"FirstSecondVerts", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{"(*", 
         RowBox[{
         "*", " ", "If", " ", "the", " ", "vertex", " ", "of", " ", 
          "FirstSecondVerts", " ", "is", " ", "an", " ", "original", " ", 
          "vertex"}], "**)"}], " ", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"OrigList", ",", " ", 
           RowBox[{"FirstSecondVerts", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
         RowBox[{"(*", 
          RowBox[{
          "*", " ", "THEN", " ", "these", " ", "equations", " ", "hold"}], 
          "**)"}], " ", 
         RowBox[{
          RowBox[{"eq3", "=", 
           RowBox[{
            RowBox[{"coor", ".", "Q", ".", 
             RowBox[{"Lookup", "[", 
              RowBox[{"InvCoordDict", ",", " ", "DualLine"}], "]"}]}], 
            "\[Equal]", "0"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"eq4", "=", 
           RowBox[{
            RowBox[{"coor", ".", "Q", ".", 
             RowBox[{"Lookup", "[", 
              RowBox[{"InvCoordDict", ",", " ", "OrigLine"}], "]"}]}], 
            "\[Equal]", "1"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "*", "We", " ", "solve", " ", "these", " ", "equations", " ", 
            "and", " ", "put", " ", "the", " ", "solution", " ", "in", " ", 
            "the", " ", "InvCoordDict"}], "**)"}], "\[IndentingNewLine]", 
          RowBox[{"AssociateTo", "[", 
           RowBox[{"InvCoordDict", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"FirstSecondVerts", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"x", ",", " ", "y", ",", " ", "z", ",", " ", "w"}], 
               "}"}]}], "/.", 
             RowBox[{
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{"eq1", "&&", "eq2", "&&", "eq3", "&&", "eq4"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", " ", "z", ",", " ", "w"}], 
                 "}"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"firstwhitevert", "=", 
           RowBox[{"FirstSecondVerts", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"CoordKnown", ",", " ", 
            RowBox[{"FirstSecondVerts", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"(*", 
          RowBox[{"*", 
           RowBox[{"OTHERWISE", "--"}], "the", " ", "vertex", " ", "is", " ", 
           "a", " ", "dual", " ", "vertex", " ", "and", " ", "these", " ", 
           "equations", " ", "hold"}], "**)"}], "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"eq3", "=", 
           RowBox[{
            RowBox[{"coor", ".", "Q", ".", 
             RowBox[{"Lookup", "[", 
              RowBox[{"InvCoordDict", ",", " ", "DualLine"}], "]"}]}], 
            "\[Equal]", "1"}]}], ";", "\[IndentingNewLine]", "\t", 
          RowBox[{"eq4", "=", 
           RowBox[{
            RowBox[{"coor", ".", "Q", ".", 
             RowBox[{"Lookup", "[", 
              RowBox[{"InvCoordDict", ",", " ", "OrigLine"}], "]"}]}], 
            "\[Equal]", "0"}]}], ";", " ", "\[IndentingNewLine]", "\t", 
          RowBox[{"(*", 
           RowBox[{
           "*", "We", " ", "solve", " ", "these", " ", "equations", " ", 
            "and", " ", "put", " ", "the", " ", "solution", " ", "in", " ", 
            "the", " ", "InvCoordDict"}], "**)"}], "\[IndentingNewLine]", 
          "\t", 
          RowBox[{"AssociateTo", "[", 
           RowBox[{"InvCoordDict", ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"FirstSecondVerts", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"x", ",", " ", "y", ",", " ", "z", ",", " ", "w"}], 
               "}"}]}], "/.", 
             RowBox[{
              RowBox[{"Solve", "[", 
               RowBox[{
                RowBox[{"eq1", "&&", "eq2", "&&", "eq3", "&&", "eq4"}], ",", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y", ",", " ", "z", ",", " ", "w"}], 
                 "}"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"firstblackvert", "=", 
           RowBox[{"FirstSecondVerts", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], " ", ";", "\[IndentingNewLine]",
           "\t", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"CoordKnown", ",", " ", 
            RowBox[{"FirstSecondVerts", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";", "\n", 
    RowBox[{"CV", "=", 
     RowBox[{"{", "CornerVert", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"CartesianDict", "=", 
     RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"InCartesianList", "=", 
     RowBox[{"{", "CornerVert", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AssociateTo", "[", 
     RowBox[{"CartesianDict", ",", " ", 
      RowBox[{"CornerVert", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0"}], "}"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"kitelist", "=", 
     RowBox[{
      RowBox[{"Lookup", "[", 
       RowBox[{"PairToCVDict", ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"firstwhitevert", ",", "firstblackvert"}], "}"}], "}"}]}], 
       "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Length", "[", "kitelist", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"branchinglist", "=", 
     RowBox[{"{", "}"}]}], ";", "\n", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "<", 
       RowBox[{
        RowBox[{"Length", "[", "kitelist", "]"}], "+", "1"}]}], ",", 
      RowBox[{"i", "++"}], ",", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"branchinglist", ",", " ", 
        RowBox[{"kitelist", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"*", " ", "getKite", 
      RowBox[{"(", ")"}], " ", "Function"}], " ", "**)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getKite", "[", "cv_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"CV", "=", "cv"}], ",", " ", "Radius"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"knownB", "=", "1000"}], ";", "\[IndentingNewLine]", 
        RowBox[{"knownW", "=", "1000"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"*", " ", 
           RowBox[{"Print", "[", "\"\<We are working with:\>\"", "]"}]}], 
          ";"}], " ", "**)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"*", " ", 
           RowBox[{"Print", "[", "CV", "]"}]}], ";"}], " ", "**)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"(*", 
          RowBox[{
          "*", " ", "If", " ", "this", " ", "crossing", " ", "vertex", " ", 
           "is", " ", "\"\<done\>\""}], "**)"}], " ", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{"CV", ",", " ", "CVDone"}], "]"}], ",", " ", 
          RowBox[{"(*", 
           RowBox[{
           "*", " ", "THEN", " ", "delete", " ", "it", " ", "from", " ", 
            "the", " ", "branching", " ", "list"}], "**)"}], " ", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"branchinglist", ",", "CV"}], "]"}], ",", "  ", 
          RowBox[{"(*", 
           RowBox[{
           "*", " ", "ELSE", " ", "proceed", " ", "with", " ", "the", " ", 
            "function"}], "**)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"adlist", "=", 
            RowBox[{"Lookup", "[", 
             RowBox[{"AdjDict", ",", " ", "CV"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"*", " ", 
              RowBox[{"Print", "[", "adlist", "]"}]}], ";"}], " ", "**)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"knownWList", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"knownBList", "=", 
            RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{"(*", 
             RowBox[{
             "*", " ", "For", " ", "each", " ", "vertex", " ", "in", " ", 
              "the", " ", "adjacency", " ", "list"}], " ", "**)"}], " ", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", " ", 
             RowBox[{"i", "<", 
              RowBox[{
               RowBox[{"Length", "[", "adlist", "]"}], "+", "1"}]}], ",", " ", 
             RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"*", " ", 
                RowBox[{"Print", "[", 
                 RowBox[{"adlist", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Print", "[", "\"\<Adjacency List above\>\"", "]"}], 
               ";"}], " ", "**)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", " ", 
              RowBox[{"(*", 
               RowBox[{
               "*", " ", "If", " ", "the", " ", "vertex", " ", "already", " ",
                 "has", " ", "coordinates"}], " ", "**)"}], " ", 
              RowBox[{
               RowBox[{"MemberQ", "[", 
                RowBox[{"CoordKnown", ",", 
                 RowBox[{"adlist", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "*", "THEN", " ", "delete", " ", "the", " ", "vertex", " ", 
                 "from", " ", "the", " ", "adjacency", " ", "list", " ", 
                 "and", " ", "check", " ", "whether", " ", "the", " ", 
                 "vertex", " ", "is", " ", "original", " ", "or", " ", 
                 "dual"}], " ", "**)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"DeleteCases", "[", 
                 RowBox[{"adlist", ",", 
                  RowBox[{"adlist", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"*", " ", 
                  RowBox[{
                  "Print", "[", "\"\<Vertex already has coordinates\>\"", 
                   "]"}]}], " ", "**)"}], "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{"(*", 
                  RowBox[{
                  "*", " ", "If", " ", "the", " ", "vertex", " ", "is", " ", 
                   "original"}], " ", "**)"}], " ", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"OrigList", ",", " ", 
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "*", " ", "THEN", " ", "label", " ", "this", " ", "vertex",
                     " ", "as", " ", "knownW"}], " ", "**)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"knownW", " ", "=", " ", 
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"knownWList", ",", " ", "knownW"}], "]"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"*", " ", 
                    RowBox[{
                    "Print", "[", "\"\<This is a known White vert\>\"", 
                    "]"}]}], " ", "**)"}], " ", 
                  RowBox[{"(*", 
                   RowBox[{
                   "*", " ", "ELSE", " ", "label", " ", "this", " ", "vertex",
                     " ", "as", " ", "known", " ", "B"}], " ", "**)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"knownB", " ", "=", " ", 
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"AppendTo", "[", 
                    RowBox[{"knownBList", ",", " ", "knownB"}], "]"}]}]}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"*", " ", 
                   RowBox[{
                   "Print", "[", "\"\<This a known Black vert\>\"", "]"}]}], 
                  " ", "**)"}], "\[IndentingNewLine]", "]"}]}]}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "*", " ", "Note", " ", "that", " ", "knownWList", " ", "and", " ",
              "knownBList", " ", "will", " ", "have", " ", "maximum", " ", 
             "length", " ", "2"}], " ", "**)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"(*", 
             RowBox[{
             "*", " ", "Only", " ", "proceed", " ", "if", " ", "there", " ", 
              "is", " ", "a", " ", "knownW", " ", "and", " ", "knownB"}], " ",
              "**)"}], " ", 
            RowBox[{
             RowBox[{
              RowBox[{"knownW", "\[NotEqual]", "1000"}], " ", "&&", " ", 
              RowBox[{"knownB", " ", "\[NotEqual]", " ", "1000"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"*", " ", 
                RowBox[{
                "Print", "[", 
                 "\"\<We are proceeding because we have enough \
information\>\"", "]"}]}], ";"}], " ", "**)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"pair1", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"knownWList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                 RowBox[{"knownBList", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"(*", 
                RowBox[{
                "*", " ", "If", " ", "this", " ", "is", " ", "a", " ", 
                 "legitimate", " ", "pair"}], " ", "**)"}], " ", 
               RowBox[{
                RowBox[{"MemberQ", "[", 
                 RowBox[{"KitePairs", ",", " ", "pair1"}], "]"}], ",", 
                RowBox[{"(*", 
                 RowBox[{
                 "*", " ", "then", " ", "look", " ", "up", " ", "the", " ", 
                  "known", " ", "cross", " ", "vert"}], " ", "**)"}], " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"knownCrossVert", "=", 
                   RowBox[{"getRemainingKiteVertex", "[", 
                    RowBox[{"CV", ",", " ", 
                    RowBox[{"pair1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"pair1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "*", " ", "If", " ", "we", " ", "have", " ", "visited", 
                    " ", "this", " ", "known", " ", "cross", " ", "vert"}], 
                    ",", " ", 
                    RowBox[{
                    RowBox[{"i", ".", "e", ".", " ", "it"}], " ", "has", " ", 
                    "coordinates"}]}], " ", "**)"}], " ", 
                   RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"CVDone", ",", " ", "knownCrossVert"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"CVCartesianCoord", "=", 
                    RowBox[{"reflection", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"CartesianDict", ",", " ", "knownCrossVert"}], 
                    "]"}], ",", " ", 
                    RowBox[{"getCartesian", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", 
                    RowBox[{"pair1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", " ", 
                    RowBox[{"getCartesian", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", 
                    RowBox[{"pair1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ";"}]}], "\[IndentingNewLine]", "]"}], ";", " ", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"knownBList", "\[Equal]", "2"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"pair2", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"knownWList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"knownBList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"KitePairs", ",", " ", "pair2"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"knownCrossVert", "=", 
                    RowBox[{"getRemainingKiteVertex", "[", 
                    RowBox[{"CV", ",", " ", 
                    RowBox[{"pair2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"pair2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"CVDone", ",", " ", "knownCrossVert"}], "]"}], 
                    ",", " ", 
                    RowBox[{
                    RowBox[{"CVCartesianCoord", "=", 
                    RowBox[{"reflection", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"CartesianDict", ",", " ", "knownCrossVert"}], 
                    "]"}], ",", " ", 
                    RowBox[{"getCartesian", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", 
                    RowBox[{"pair2", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", " ", 
                    RowBox[{"getCartesian", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", 
                    RowBox[{"pair2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "]"}]}]}], 
                   "]"}], ";", " ", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "knownWList", "]"}], "\[Equal]", 
                    "2"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"pair3", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"knownWList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"knownBList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"KitePairs", ",", " ", "pair3"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"knownCrossVert", "=", 
                    RowBox[{"getRemainingKiteVertex", "[", 
                    RowBox[{"CV", ",", " ", 
                    RowBox[{"pair3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"pair3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"CVDone", ",", " ", "knownCrossVert"}], "]"}], 
                    ",", " ", 
                    RowBox[{
                    RowBox[{"CVCartesianCoord", "=", 
                    RowBox[{"reflection", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"CartesianDict", ",", " ", "knownCrossVert"}], 
                    "]"}], ",", " ", 
                    RowBox[{"getCartesian", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", 
                    RowBox[{"pair3", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", " ", 
                    RowBox[{"getCartesian", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", 
                    RowBox[{"pair3", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ";"}]}], "\[IndentingNewLine]", "]"}]}]}], "]"}]}]}], 
                   "]"}], ";", " ", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "knownWList", "]"}], "\[Equal]", 
                    "2"}], "&&", 
                    RowBox[{
                    RowBox[{"Length", "[", "knownBList", "]"}], "\[Equal]", 
                    "2"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"pair4", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"knownWList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"knownBList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"KitePairs", ",", " ", "pair4"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"knownCrossVert", "=", 
                    RowBox[{"getRemainingKiteVertex", "[", 
                    RowBox[{"CV", ",", " ", 
                    RowBox[{"pair4", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"pair4", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"KitePairs", ",", " ", "pair4"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"knownCrossVert", "=", 
                    RowBox[{"getRemainingKiteVertex", "[", 
                    RowBox[{"CV", ",", " ", 
                    RowBox[{"pair4", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"pair4", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"CVDone", ",", " ", "knownCrossVert"}], "]"}], 
                    ",", " ", 
                    RowBox[{
                    RowBox[{"CVCartesianCoord", "=", 
                    RowBox[{"reflection", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"CartesianDict", ",", " ", "knownCrossVert"}], 
                    "]"}], ",", " ", 
                    RowBox[{"getCartesian", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", 
                    RowBox[{"pair4", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", " ", 
                    RowBox[{"getCartesian", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", 
                    RowBox[{"pair4", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}]}], "]"}]}],
                     ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    "\[IndentingNewLine]", "]"}]}]}], "]"}]}]}], "]"}]}]}], 
                   "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"(*", 
                    RowBox[{
                    "*", " ", "If", " ", "CV", " ", "is", " ", "not", " ", 
                    "the", " ", "corner", " ", "vert"}], " ", "**)"}], 
                   RowBox[{
                    RowBox[{"CV", "\[NotEqual]", "CornerVert"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<knownW,\>\"", ",", " ", "knownWList"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<knownB,\>\"", ",", " ", "knownBList"}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<knownCrossVert\>\"", ",", " ", "knownCrossVert"}], 
                    "]"}], ";"}], " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"CartesianDict", ",", 
                    RowBox[{"CV", "\[Rule]", "CVCartesianCoord"}]}], "]"}]}], 
                   "]"}], ";"}], "\[IndentingNewLine]", ";", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{"(*", 
                   RowBox[{
                   "*", " ", "AGAIN", " ", "for", " ", "each", " ", "vertex", 
                    " ", "in", " ", "the", " ", "adjacency", " ", "list"}], 
                   " ", "**)"}], " ", 
                  RowBox[{
                   RowBox[{"i", "=", "1"}], ",", " ", 
                   RowBox[{"i", "<", 
                    RowBox[{
                    RowBox[{"Length", "[", "adlist", "]"}], "+", "1"}]}], ",",
                    " ", 
                   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"If", " ", "[", 
                    RowBox[{"(*", 
                    RowBox[{
                    "*", " ", "If", " ", "the", " ", "vertex", " ", "does", 
                    " ", "NOT", " ", "have", " ", "coordinates"}], " ", 
                    "**)"}], " ", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"MemberQ", " ", "[", 
                    RowBox[{"CoordKnown", ",", " ", 
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "*", "THEN", " ", "proceed", " ", "to", " ", "get", " ", 
                    "coordinates"}], " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{
                    "Print", "[", 
                    "\"\<We are getting coordinates for a vertex\>\"", 
                    "]"}]}], ";"}], " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{"Print", "[", 
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";"}], " ", 
                    "**)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"coor", " ", "=", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    "x", ",", " ", "y", ",", " ", "z", ",", " ", "w"}], 
                    "}"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"eq1", "=", 
                    RowBox[{
                    RowBox[{"coor", ".", "Q", ".", "coor"}], " ", "\[Equal]", 
                    " ", 
                    RowBox[{"-", "1"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Radius", "=", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"radii", ",", " ", 
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"eq2", " ", "=", " ", 
                    RowBox[{"y", "\[Equal]", 
                    RowBox[{"1", "/", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"radii", ",", " ", 
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{"Print", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"radii", ",", " ", 
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}]}], ";"}], 
                    " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "*", " ", "IF", " ", "the", " ", "vertex", " ", "is", " ",
                     "original"}], ",", " ", 
                    RowBox[{"use", " ", "these", " ", "equations"}]}], " ", 
                    "**)"}], " ", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"OrigList", ",", " ", 
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"eq3", "=", 
                    RowBox[{
                    RowBox[{"coor", ".", "Q", ".", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", "knownW"}], "]"}]}], 
                    " ", "\[Equal]", " ", "1"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{
                    "Print", "[", "\"\<InversiveCoordinates\>\"", "]"}]}], 
                    ";"}], " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{"Print", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", "knownW"}], "]"}], 
                    "]"}]}], ";"}], " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"eq4", " ", "=", " ", 
                    RowBox[{
                    RowBox[{"coor", ".", " ", "Q", ".", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", "knownB"}], "]"}]}], 
                    "\[Equal]", "0"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"eq5", "=", 
                    RowBox[{
                    RowBox[{"coor", ".", "Q", ".", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", "OrigLine"}], "]"}]}], 
                    " ", "\[GreaterEqual]", ".95"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "*", " ", "ELSE", " ", "the", " ", "vertex", " ", "is", 
                    " ", "dual", " ", "and", " ", "use", " ", "these", " ", 
                    "equations"}], " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"eq3", "=", 
                    RowBox[{
                    RowBox[{"coor", ".", "Q", ".", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", "knownW"}], "]"}]}], 
                    " ", "\[Equal]", " ", "0"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{
                    "Print", "[", "\"\<InversiveCoordinates\>\"", "]"}]}], 
                    ";"}], " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{"Print", "[", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", "knownB"}], "]"}], 
                    "]"}]}], ";"}], " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"eq4", " ", "=", " ", 
                    RowBox[{
                    RowBox[{"coor", ".", " ", "Q", ".", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", "knownB"}], "]"}]}], 
                    "\[Equal]", "1"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"eq5", "=", 
                    RowBox[{
                    RowBox[{"coor", ".", "Q", ".", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"InvCoordDict", ",", " ", "DualLine"}], "]"}]}], 
                    " ", "\[GreaterEqual]", ".95"}]}]}]}], "]"}], ";", " ", 
                    RowBox[{"(*", 
                    RowBox[{"*", " ", 
                    RowBox[{"I", "'"}], "ve", " ", "put", " ", ".95", " ", 
                    "instead", " ", "of", " ", "1", " ", "to", " ", "give", 
                    " ", "the", " ", "computations", " ", "some", " ", 
                    "leeway"}], " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"*", " ", "Solve", " ", "the", " ", "equations"}],
                     " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"solutionList", "=", 
                    RowBox[{"Solve", "[", 
                    RowBox[{
                    RowBox[{
                    "eq1", "&&", "eq2", "&&", "eq3", "&&", "eq4", "&&", 
                    "eq5"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y", ",", " ", "z", ",", " ", "w"}], 
                    "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{"Print", "[", "solutionList", "]"}]}], ";"}], " ",
                     "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{"(*", 
                    RowBox[{
                    "*", " ", "IF", " ", "there", " ", "is", " ", "one", " ", 
                    "solution"}], " ", "**)"}], " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "solutionList", "]"}], "==", "1"}],
                     ",", " ", "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{
                    "Print", "[", "\"\<There is one solution\>\"", "]"}]}], 
                    ";"}], " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    "*", " ", "Then", " ", "assign", " ", "the", " ", 
                    "solution", " ", "of", " ", "inversive", " ", 
                    "coordinates", " ", "to", " ", "the", " ", "vertex"}], 
                    " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"InvCoordDict", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    "x", ",", " ", "y", ",", " ", "z", ",", " ", "w"}], 
                    "}"}]}], "/.", " ", 
                    RowBox[{"solutionList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"CoordKnown", ",", " ", 
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{
                    "Print", "[", "\"\<There are two solutions\>\"", "]"}]}], 
                    ";"}], " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"solution1", "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "x", ",", " ", "y", ",", " ", "z", ",", " ", "w"}], "}"}],
                     "/.", 
                    RowBox[{"solutionList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"center1", "=", 
                    RowBox[{"getCartesian", "[", "solution1", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{"Print", "[", "\"\<solution 1\>\"", "]"}]}], 
                    ";"}], " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{"Print", "[", 
                    RowBox[{"N", "[", 
                    RowBox[{"EuclideanDistance", "[", 
                    RowBox[{"center1", ",", " ", "CVCartesianCoord"}], "]"}], 
                    "]"}], "]"}]}], ";"}], " ", "**)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<radius is \>\"", ",", " ", 
                    RowBox[{"N", "[", "Radius", "]"}]}], "]"}]}], ";"}], " ", 
                    "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<the crossing verts is\>\"", ",", " ", 
                    "CVCartesianCoord"}], "]"}]}], ";"}], " ", "**)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{"Print", "[", "\"\<solution 2\>\"", "]"}]}], 
                    ";"}], " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"solution2", "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "x", ",", " ", "y", ",", " ", "z", ",", " ", "w"}], "}"}],
                     " ", "/.", " ", 
                    RowBox[{"solutionList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"center2", "=", 
                    RowBox[{"getCartesian", "[", "solution2", "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "*", " ", "IF", " ", "the", " ", "center", " ", "circle", 
                    " ", "has", " ", "radius", " ", "approx", " ", "equal", 
                    " ", "to", " ", "the", " ", "distance", " ", "from", " ", 
                    "the", " ", "CV", " ", "to", " ", "the", " ", "circle", 
                    " ", "center", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    "a", " ", "for", " ", "respective", " ", "solutions"}], 
                    ")"}]}], ",", " ", 
                    RowBox[{
                    "then", " ", "choose", " ", "that", " ", "solution"}]}], 
                    " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    RowBox[{"EuclideanDistance", "[", 
                    RowBox[{"center1", ",", " ", "CVCartesianCoord"}], "]"}], 
                    ",", " ", "3"}], "]"}], ")"}], "\[Equal]", 
                    RowBox[{"N", "[", 
                    RowBox[{"Radius", ",", " ", "3"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"InvCoordDict", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    "x", ",", " ", "y", ",", " ", "z", ",", " ", "w"}], 
                    "}"}]}], "/.", " ", 
                    RowBox[{"solutionList", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"CoordKnown", ",", " ", 
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"*", " ", "Else"}], " ", "**)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AssociateTo", "[", 
                    RowBox[{"InvCoordDict", ",", " ", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    "x", ",", " ", "y", ",", " ", "z", ",", " ", "w"}], 
                    "}"}]}], "/.", " ", 
                    RowBox[{"solutionList", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"CoordKnown", ",", " ", 
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], 
                    "\[IndentingNewLine]", "]"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"potentialcrossingverts", "=", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"AdjDict", ",", " ", 
                    RowBox[{"adlist", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    "*", " ", "We", " ", "only", " ", "add", " ", "a", " ", 
                    "vertex", " ", "from", " ", "potential", " ", "crossing", 
                    " ", "verts", " ", "to", " ", "the", " ", "branching", 
                    " ", "list", " ", "if", " ", "it", " ", "is", " ", "not", 
                    " ", "CV", " ", "and", " ", "if", " ", "it", " ", "not", 
                    " ", "in", " ", "the", " ", "CVDone", " ", "list"}], ",", 
                    " ", 
                    RowBox[{
                    RowBox[{"i", ".", "e", ".", " ", "if"}], " ", "we", " ", 
                    "have", " ", "not", " ", "run", " ", "the", " ", "code", 
                    " ", "on", " ", "the", " ", "vertex", " ", "already"}]}], 
                    " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{"j", "=", "1"}], ",", " ", 
                    RowBox[{"j", "<", " ", 
                    RowBox[{
                    RowBox[{"Length", "[", "potentialcrossingverts", "]"}], 
                    "+", "1"}]}], ",", " ", 
                    RowBox[{"j", "++"}], ",", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"potentialcrossingverts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", "CV"}], 
                    ",", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"CVDone", ",", " ", 
                    RowBox[{"potentialcrossingverts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], " ", "]"}]}], ")"}], 
                    ",", " ", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"branchinglist", ",", 
                    RowBox[{"potentialcrossingverts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "]"}]}], 
                    "]"}]}], "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{"*", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"CVDone", ",", " ", 
                    RowBox[{"potentialcrossingverts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], " ", "]"}]}], ")"}], 
                    ",", " ", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"branchinglist", ",", 
                    RowBox[{"potentialcrossingverts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    "Print", "[", 
                    "\"\<We appended something to the branching list\>\"", 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"potentialcrossingverts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", "branchinglist", "]"}]}]}], " "}]}],
                     "**)"}], "\[IndentingNewLine]", "]"}]}]}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                  "]"}], ";", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"CVDone", ",", " ", "CV"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"branchinglist", "=", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{"branchinglist", ",", "CV"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"branchinglist", "=", 
                  RowBox[{"DeleteDuplicates", "[", "branchinglist", "]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"*", " ", 
                    RowBox[{"Print", "[", "branchinglist", "]"}]}], ";"}], 
                  " ", "**)"}], "\[IndentingNewLine]", 
                 RowBox[{"previousCV", "=", "CV"}]}]}], "\[IndentingNewLine]",
                "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"getKite", "[", "CornerVert", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "*", " ", "Given", " ", "the", " ", "inversive", " ", "coordinates", 
       " ", "for", " ", "a", " ", "circle", " ", "of", " ", "finite", " ", 
       "radius"}], ",", " ", 
      RowBox[{
      "this", " ", "function", " ", "returns", " ", "the", " ", "center", " ",
        "of", " ", "the", " ", "circle"}]}], " ", "**)"}], " ", 
    "\[IndentingNewLine]", 
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "branchinglist", "]"}], "\[NotEqual]", "0"}], 
      " ", 
      RowBox[{"(*", 
       RowBox[{
       "*", " ", "While", " ", "there", " ", "are", " ", "vertices", " ", 
        "left", " ", "in", " ", "the", " ", "branchinglist"}], " ", "**)"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"Scan", "[", 
       RowBox[{"getKite", ",", "branchinglist"}], "]"}]}], " ", 
     "\[IndentingNewLine]", "]"}], " ", ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eq1", ",", " ", "eq2", ",", " ", "eq3", ",", " ", "eq4"}], 
       "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{"(*", 
        RowBox[{"*", " ", "For", " ", "each", " ", "line"}], " ", "**)"}], 
       " ", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", " ", 
        RowBox[{"i", "<", 
         RowBox[{
          RowBox[{"Length", "[", "AdjToInfty", "]"}], "+", "1"}]}], ",", " ", 
        RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "*", " ", "IF", " ", "coordinates", " ", "of", " ", "the", " ", 
             "line", " ", "are", " ", "not", " ", "knonwn"}], ",", " ", 
            "prooceed"}], " ", "**)"}], " ", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"CoordKnown", ",", " ", 
              RowBox[{"AdjToInfty", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", " ", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"*", " ", 
              RowBox[{"Print", "[", "\"\<we are proceeding\>\"", "]"}]}], 
             ";"}], " ", "**)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"ln", "=", 
             RowBox[{"{", 
              RowBox[{"x", ",", " ", "y", ",", " ", "z", ",", " ", "w"}], 
              "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"eq1", "=", " ", 
             RowBox[{
              RowBox[{"ln", ".", "Q", ".", "ln"}], " ", "\[Equal]", " ", 
              RowBox[{"-", "1"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"eq2", " ", "=", " ", 
             RowBox[{"y", "\[Equal]", " ", "0"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"crossinglist", "=", 
             RowBox[{"Lookup", "[", 
              RowBox[{"AdjToAdjToInftyDict", ",", " ", 
               RowBox[{"AdjToInfty", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"whitecenterverts", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"blackcenterverts", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"k", "=", "1"}], ",", " ", 
              RowBox[{"k", "<", 
               RowBox[{
                RowBox[{"Length", "[", "crossinglist", "]"}], "+", "1"}]}], 
              ",", " ", 
              RowBox[{"k", "++"}], ",", " ", 
              RowBox[{
               RowBox[{"centerverts", "=", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"AdjDict", ",", " ", 
                  RowBox[{"crossinglist", "[", 
                   RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"*", " ", 
                  RowBox[{"Print", "[", "centerverts", "]"}]}], ";"}], " ", 
                "**)"}], "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"j", "=", "1"}], ",", " ", 
                 RowBox[{"j", "<", 
                  RowBox[{
                   RowBox[{"Length", "[", "centerverts", "]"}], "+", "1"}]}], 
                 ",", " ", 
                 RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"MemberQ", "[", 
                    RowBox[{"OrigList", ",", " ", 
                    RowBox[{"centerverts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", " ", 
                   RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"whitecenterverts", ",", " ", 
                    RowBox[{"centerverts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"*", " ", 
                    RowBox[{
                    "Print", "[", "\"\<adding to whitecenterverts\>\"", 
                    "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "Print", "[", "\"\<adding to blackcenterverts\>\"", "]"}],
                     ";"}]}], " ", "**)"}], "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"blackcenterverts", ",", " ", 
                    RowBox[{"centerverts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"whitecenterverts", "=", 
             RowBox[{"DeleteDuplicates", "[", "whitecenterverts", "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"blackcenterverts", "=", 
             RowBox[{"DeleteDuplicates", "[", "blackcenterverts", "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"(*", 
              RowBox[{
              "*", " ", "IF", " ", "the", " ", "line", " ", "is", " ", "an", 
               " ", "original", " ", "line"}], " ", "**)"}], " ", 
             RowBox[{
              RowBox[{"MemberQ", "[", 
               RowBox[{"OrigList", ",", " ", 
                RowBox[{"AdjToInfty", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"*", " ", "THEN", " ", "proceed", " ", "here"}], 
               "**)"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"w1c", "=", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"InvCoordDict", ",", " ", 
                  RowBox[{"whitecenterverts", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"eq3", "=", 
                RowBox[{
                 RowBox[{"w1c", ".", "Q", ".", "ln"}], " ", "\[Equal]", " ", 
                 "1"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"eq4", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Lookup", "[", 
                   RowBox[{"InvCoordDict", ",", " ", "OrigLine"}], "]"}], ".",
                   "Q", ".", "ln"}], " ", "\[Equal]", " ", "1"}]}]}], ",", 
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "*", " ", "ELSE", " ", "the", " ", "line", " ", "is", " ", 
                "dual", " ", "and", " ", "proceed", " ", "here"}], " ", 
               "**)"}], " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"w0c", " ", "=", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"InvCoordDict", ",", " ", 
                  RowBox[{"whitecenterverts", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{"eq3", "=", 
                RowBox[{
                 RowBox[{"w0c", ".", "Q", ".", "ln"}], " ", "\[Equal]", 
                 "0"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"eq4", " ", "=", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Lookup", "[", 
                   RowBox[{"InvCoordDict", ",", " ", "DualLine"}], "]"}], ".",
                   "Q", ".", "ln"}], " ", "\[Equal]", " ", "1"}]}]}]}], "]"}],
             ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"solutionList", "=", 
             RowBox[{"Solve", "[", 
              RowBox[{
               RowBox[{"eq1", "&&", "eq2", "&&", "eq3", "&&", "eq4"}], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "y", ",", " ", "z", ",", " ", "w"}], 
                "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"equationlist", "=", 
             RowBox[{"{", 
              RowBox[{
              "eq1", ",", " ", "eq2", ",", " ", "eq3", ",", " ", "eq4"}], 
              "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"AssociateTo", "[", 
             RowBox[{"InvCoordDict", ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"AdjToInfty", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"x", ",", " ", "y", ",", " ", "z", ",", " ", "w"}], 
                 "}"}]}], "/.", " ", 
               RowBox[{"solutionList", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"CoordKnown", ",", " ", 
              RowBox[{"AdjToInfty", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], " ", "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"InvCoordVec", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", " ", 
      RowBox[{"i", "<", 
       RowBox[{
        RowBox[{"Length", "[", "CoordKnown", "]"}], "+", "1"}]}], ",", " ", 
      RowBox[{"i", "++"}], ",", " ", 
      RowBox[{
       RowBox[{"vec", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"RootApproximant", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SendToInt", "[", 
               RowBox[{"1", "/", "100"}], "]"}], "/@", 
              RowBox[{"Lookup", "[", 
               RowBox[{"InvCoordDict", ",", " ", 
                RowBox[{"CoordKnown", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", " ", "25"}], 
            "]"}], ",", " ", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AssociateTo", "[", 
        RowBox[{"InvCoordDict", ",", " ", 
         RowBox[{
          RowBox[{"CoordKnown", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "->", "vec"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"InvCoordVec", ",", " ", "vec"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"ICVPlace2Vert", "=", 
     RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AllVerts", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"OrigList", ",", " ", "DualList"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", " ", 
      RowBox[{"i", "<", 
       RowBox[{
        RowBox[{"Length", "[", "CoordKnown", "]"}], "+", "1"}]}], ",", " ", 
      RowBox[{"i", "++"}], ",", " ", 
      RowBox[{"AssociateTo", "[", 
       RowBox[{"ICVPlace2Vert", ",", 
        RowBox[{
         RowBox[{"CoordKnown", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", "i"}]}], "]"}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AllVerts", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"OrigList", ",", " ", "DualList"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CheckCluster", "[", "List_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"adlist", ",", " ", "adlist2", ",", " ", "intersectionlist"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", " ", 
         RowBox[{"i", "<", 
          RowBox[{"Length", "[", "List", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "*", " ", "For", " ", "every", " ", "circle", " ", "in", " ", "the",
            " ", "cluster"}], " ", "**)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "*", " ", "get", " ", "the", " ", "vertices", " ", "adjacent", " ", 
           "to", " ", "it"}], " ", "**)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"adlist", "=", 
           RowBox[{"Lookup", "[", 
            RowBox[{"AdjDict", ",", " ", 
             RowBox[{"List", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "*", " ", "Now", " ", "for", " ", "every", " ", "other", " ", 
             "vertex"}], ",", " ", 
            RowBox[{
            "also", " ", "get", " ", "the", " ", "adjacency", " ", "list"}]}],
            " ", "**)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", " ", 
            RowBox[{"j", "<", 
             RowBox[{"Length", "[", "AllVerts", "]"}]}], ",", " ", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"adlist2", "=", 
              RowBox[{"Lookup", "[", 
               RowBox[{"AdjDict", ",", " ", 
                RowBox[{"AllVerts", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"intersectionlist", "=", 
              RowBox[{"Intersection", "[", 
               RowBox[{"adlist", ",", " ", "adlist2"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Cond1", "=", 
              RowBox[{
               RowBox[{"Length", "[", "intersectionlist", "]"}], 
               "\[NotEqual]", "0"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Cond2", "=", 
              RowBox[{
               RowBox[{"AllVerts", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", 
               RowBox[{"List", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "*", " ", "If", " ", "the", " ", "circle", " ", "vertex", " ", 
               "shares", " ", "a", " ", "crossing", " ", "vertex", " ", 
               "with", " ", "another", " ", "vertex"}], " ", "**)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "*", " ", "Check", " ", "if", " ", "the", " ", "second", " ", 
               "vertex", " ", "is", " ", "original"}], " ", "**)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Cond1", "&&", "Cond2"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"OrigList", ",", " ", 
                    RowBox[{"AllVerts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "*", " ", "Check", " ", "if", " ", "there", " ", "is", " ",
                     "a", " ", "1", " ", "in", " ", "the", " ", "Gram", "  ", 
                    "matrix"}], " ", "**)"}], "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"GramMatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"(*", "*", " ", "**)"}], " ", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"ICVPlace2Vert", ",", " ", 
                    RowBox[{"AllVerts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], " ", 
                    RowBox[{"(*", "*", " ", "**)"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"(*", "*", " ", "**)"}], " ", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"ICVPlace2Vert", ",", " ", 
                    RowBox[{"OrigList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], " ", 
                    RowBox[{"(*", "*", " ", "**)"}], "]"}], "]"}], 
                    "\[NotEqual]", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"CheckingIfGramIsCorrect", ",", " ", "5"}], 
                    "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "*", " ", "Check", " ", "if", " ", "the", " ", "second", " ",
                   "vertex", " ", "is", " ", "dual"}], " ", "**)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"DualList", ",", " ", 
                    RowBox[{"AllVerts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "*", " ", "Check", " ", "if", " ", "there", " ", "is", " ",
                     "a", " ", "0", " ", "in", " ", "the", " ", "Gram", " ", 
                    "matrix"}], " ", "**)"}], "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"GramMatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"(*", "*", " ", "**)"}], " ", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"ICVPlace2Vert", ",", " ", 
                    RowBox[{"AllVerts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], 
                    RowBox[{"(*", "*", " ", "**)"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"(*", "*", " ", "**)"}], 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"ICVPlace2Vert", ",", " ", 
                    RowBox[{"OrigList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], 
                    RowBox[{"(*", "*", " ", "**)"}], "]"}], "]"}], 
                    "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{
                    RowBox[{"GramMatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"(*", "*", " ", "**)"}], " ", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"ICVPlace2Vert", ",", " ", 
                    RowBox[{"AllVerts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], 
                    RowBox[{"(*", "*", " ", "**)"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"(*", "*", " ", "**)"}], 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"ICVPlace2Vert", ",", " ", 
                    RowBox[{"OrigList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], 
                    RowBox[{"(*", "*", " ", "**)"}], "]"}], "]"}], "]"}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"CheckingIfGramIsCorrect", ",", " ", "5"}], 
                    "]"}]}]}], "]"}]}], "]"}]}]}], "]"}]}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"GramMatrix", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Gram", "[", "InvCoordVec_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", " ", 
          RowBox[{"j", "<", " ", 
           RowBox[{
            RowBox[{"Length", "[", "InvCoordVec", "]"}], "+", "1"}]}], ",", 
          " ", 
          RowBox[{"j", "++"}], ",", " ", 
          RowBox[{
           RowBox[{"vector1", "=", 
            RowBox[{"InvCoordVec", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"gramRow", "=", 
            RowBox[{"{", "}"}]}], ";", " ", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"k", "=", "1"}], ",", " ", 
             RowBox[{"k", "<", 
              RowBox[{
               RowBox[{"Length", "[", "InvCoordVec", "]"}], "+", "1"}]}], ",",
              " ", 
             RowBox[{"k", "++"}], ",", " ", 
             RowBox[{
              RowBox[{"vector2", "=", 
               RowBox[{"InvCoordVec", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ";", " ", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"gramRow", ",", " ", 
                RowBox[{"Simplify", "[", 
                 RowBox[{"vector1", ".", "Q", ".", "vector2"}], "]"}]}], 
               "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"GramMatrix", ",", " ", "gramRow"}], "]"}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", "GramMatrix"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DrawCircle", "[", 
      RowBox[{"{", 
       RowBox[{"bhat_", ",", "b_", ",", "bx_", ",", "by_"}], "}"}], "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"b", "\[NotEqual]", "0"}], ",", 
       RowBox[{"Circle", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"bx", ",", "by"}], "}"}], "/", "b"}], ",", 
         RowBox[{"1", "/", "b"}]}], "]"}], ",", 
       RowBox[{"InfiniteLine", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"bx", ",", "by"}], "}"}], 
          RowBox[{"bhat", "/", "2"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "by"}], ",", "bx"}], "}"}]}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Render", "[", 
      RowBox[{"DualList_", ",", " ", "OrigList_"}], "]"}], ":=", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{"Blue", ",", "Thick", ",", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"DrawCircle", "[", 
           RowBox[{"Lookup", "[", 
            RowBox[{"InvCoordDict", ",", " ", 
             RowBox[{"OrigList", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "OrigList", "]"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "Red", ",", "Dashed", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"DrawCircle", "[", 
           RowBox[{"Lookup", "[", 
            RowBox[{"InvCoordDict", ",", " ", 
             RowBox[{"DualList", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "DualList", "]"}]}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"*", " ", 
      RowBox[{"Render", "[", 
       RowBox[{"DualList", ",", " ", "OrigList"}], "]"}]}], " ", "**)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"cluster", " ", "=", " ", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"cocluster", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", " ", 
      RowBox[{"i", "<", 
       RowBox[{
        RowBox[{"Length", "[", "OrigList", "]"}], "+", "1"}]}], ",", " ", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"cluster", ",", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"InvCoordDict", ",", 
          RowBox[{"OrigList", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", " ", 
      RowBox[{"i", "<", 
       RowBox[{
        RowBox[{"Length", "[", "DualList", "]"}], "+", "1"}]}], ",", " ", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"cocluster", ",", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{"InvCoordDict", ",", 
          RowBox[{"DualList", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Vout", "=", 
     RowBox[{"MatrixForm", "[", "InvCoordVec", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"n", "=", 
     RowBox[{"Length", "[", "OrigList", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"R", "[", "vhat_", "]"}], ":=", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "4", "]"}], "+", 
      RowBox[{"2", "*", 
       RowBox[{"Q", ".", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "vhat", "}"}], "]"}], ".", 
        RowBox[{"{", "vhat", "}"}]}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"BMat", "[", "n_", "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"b", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Bend3", "[", 
       RowBox[{
       "V_", ",", "n_", ",", "cocluster_", ",", " ", "cluster_", ",", " ", 
        RowBox[{"RING_", ":", "Integers"}]}], "]"}], "[", "i_", "]"}], ":=", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"V", " ", "is", " ", "a", " ", "supercluster", " ", 
         RowBox[{"matrix", ".", " ", "iso"}], " ", "is", " ", "the", " ", 
         "indices", " ", "of", " ", "the", " ", 
         RowBox[{"cluster", ".", " ", "1"}]}], "\[LessEqual]", "i", 
        "\[LessEqual]"}], "|", "cocluster", "|"}], " ", "*)"}], 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "sol", ",", "assignments", ",", "rest", ",", "j", ",", "l", ",", 
         "others1", ",", "others2", ",", 
         RowBox[{"co", "=", "cocluster"}], ",", 
         RowBox[{"cl", "=", "cluster"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sol", "=", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"BMat", "[", "n", "]"}], ".", "cl"}], "==", 
            RowBox[{"cl", ".", 
             RowBox[{"R", "[", 
              RowBox[{"co", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], ",", "RING"}], 
          "]"}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"*", " ", "Solve", " ", "BV"}], "=", "VR"}], " ", "**)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"*", " ", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<sol\>\"", ",", " ", "sol"}], "]"}]}], ";"}], " ", 
         "**)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"sol", "==", 
           RowBox[{"{", "}"}]}], ",", "Null", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"sol", "=", 
            RowBox[{"sol", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"assignments", "=", 
            RowBox[{"Association", "[", "sol", "]"}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "*", " ", "make", " ", "a", " ", "dictionary", " ", "of", " ", 
              "the", " ", "variables"}], ",", " ", 
             RowBox[{
              RowBox[{"i", ".", "e", ".", " ", "elements"}], " ", "of", " ", 
              "BMat"}], ",", " ", 
             RowBox[{"and", " ", "the", " ", "solutions"}]}], " ", "**)"}], 
           " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"*", " ", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<assignments\>\"", ",", " ", "assignments"}], 
               "]"}]}], ";"}], " ", "**)"}], "\[IndentingNewLine]", 
           RowBox[{"rest", "=", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"BMat", "[", "n", "]"}], "]"}], ",", 
              RowBox[{"Keys", "[", "assignments", "]"}]}], "]"}]}], ";", "  ", 
           RowBox[{"(*", 
            RowBox[{
            "*", " ", "rest", " ", "is", " ", "a", " ", "list", " ", "of", 
             " ", "variables", " ", "that", " ", "do", " ", "not", " ", 
             "have", " ", "a", " ", "solution"}], " ", "**)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"*", " ", 
              RowBox[{"Print", "[", 
               RowBox[{"\"\<rest\>\"", ",", " ", "rest"}], "]"}]}], ";"}], 
            " ", "**)"}], "\[IndentingNewLine]", 
           RowBox[{"l", "=", 
            RowBox[{"Length", "[", "rest", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"*", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"l", "==", "0"}], ",", 
               RowBox[{"MatrixForm", "[", 
                RowBox[{"Simplify", "[", 
                 RowBox[{
                  RowBox[{"BMat", "[", "n", "]"}], "/.", "assignments"}], 
                 "]"}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"others1", "=", 
                 RowBox[{
                  RowBox[{"Solve", "[", 
                   RowBox[{"rest", "==", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "l"}], "}"}]}], "]"}]}], 
                   "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"others2", "=", 
                 RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"j", "=", "1"}], ",", 
                  RowBox[{"j", "\[LessEqual]", "l"}], ",", 
                  RowBox[{"j", "++"}], ",", 
                  RowBox[{
                   RowBox[{"others2", "[", 
                    RowBox[{"rest", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "=", 
                   RowBox[{"Subscript", "[", 
                    RowBox[{"a", ",", " ", "j"}], "]"}]}]}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"others2", "=", 
                 RowBox[{"Normal", "[", "others2", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"MatrixForm", "[", 
                 RowBox[{"Simplify", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"BMat", "[", "n", "]"}], "/.", 
                    RowBox[{"(", 
                    RowBox[{"assignments", "/.", "others1"}], ")"}]}], ")"}], 
                   "/.", "others1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]",
               "]"}]}], "\[IndentingNewLine]", "**)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"l", "\[Equal]", "0"}], ",", " ", 
             RowBox[{"(*", 
              RowBox[{
              "*", " ", "IF", " ", "all", " ", "variables", " ", "have", " ", 
               "solutions"}], " ", "**)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"*", " ", "THEN", " ", 
                RowBox[{"BMat", "[", "n", "]"}]}], " ", "/.", " ", 
               RowBox[{
               "assignments", " ", "puts", " ", "all", " ", "of", " ", "the", 
                " ", "solutions", " ", "into", " ", "the", " ", "matrix", " ",
                 "B"}]}], " ", "**)"}], "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"*", " ", 
               RowBox[{"/.", " ", 
                RowBox[{
                "replaces", " ", "any", " ", "free", " ", "variable", " ", 
                 "c", " ", "with", " ", "0", "??"}]}]}], " ", "**)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "*", " ", "output", " ", "the", " ", "matrix", " ", "form"}], 
              " ", "**)"}], "\[IndentingNewLine]", 
             RowBox[{"MatrixForm", "[", 
              RowBox[{"Simplify", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"BMat", "[", "n", "]"}], "/.", "assignments"}], "/.", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"C", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "3", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "4", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "5", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "6", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "7", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "8", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "9", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "10", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "11", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "12", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "13", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "14", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "15", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "16", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "17", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "18", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "19", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "20", "]"}], "\[Rule]", "0"}], ",", 
                  RowBox[{
                   RowBox[{"C", "[", "21", "]"}], "\[Rule]", "0"}]}], "}"}]}],
                "]"}], "]"}], ",", " ", 
             RowBox[{"(*", 
              RowBox[{
              "*", " ", "ELSE", " ", "we", " ", "make", " ", "rest", " ", "a",
                " ", "table", " ", "of", " ", 
               RowBox[{"0", "'"}], "s", " ", "of", " ", "length", " ", "of", 
               " ", "rest", "??"}], " ", "**)"}], "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"others1", "=", 
               RowBox[{
                RowBox[{"Solve", "[", 
                 RowBox[{"rest", "\[Equal]", 
                  RowBox[{"Table", "[", 
                   RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "l"}], "}"}]}], "]"}]}], 
                 "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
              "\[IndentingNewLine]", 
              RowBox[{"others2", "=", 
               RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "*", " ", "for", " ", "j", " ", "from", " ", "1", " ", "to", 
                 " ", "length", " ", "of", " ", "rest"}], ",", " ", 
                RowBox[{
                "make", " ", "a", " ", "key", " ", "in", " ", "others2", " ", 
                 "equal", " ", "to", " ", "the", " ", "index", " ", "of", " ",
                  "each", " ", "element", " ", "of", " ", "rest", " ", "and", 
                 " ", "make", " ", "the", " ", "value", " ", "a", " ", 
                 "subscripted", " ", "to", " ", "that", " ", "index"}]}], " ",
                "**)"}], "\[IndentingNewLine]", 
              RowBox[{"For", "[", 
               RowBox[{
                RowBox[{"j", "=", "1"}], ",", 
                RowBox[{"j", "\[LessEqual]", "l"}], ",", 
                RowBox[{"j", "++"}], ",", 
                RowBox[{
                 RowBox[{"others2", "[", 
                  RowBox[{"rest", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "=", 
                 RowBox[{"Subscript", "[", 
                  RowBox[{"a", ",", "j"}], "]"}]}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{"*", " ", 
                RowBox[{"Normal", "[", "]"}], " ", "converts", " ", "the", 
                " ", "association", " ", "to", " ", "a", " ", "list", " ", 
                "of", " ", "rules"}], " ", "**)"}], "\[IndentingNewLine]", 
              RowBox[{"others2", "=", 
               RowBox[{"Normal", "[", "others2", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"MatrixForm", "[", 
               RowBox[{"Simplify", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"BMat", "[", "n", "]"}], "/.", 
                   RowBox[{"(", 
                    RowBox[{"assignments", "/.", "others1"}], ")"}]}], ")"}], 
                 "/.", "others1"}], "]"}], "]"}]}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Bend4", "[", 
       RowBox[{"V_", ",", "n_"}], "]"}], "[", "i_", "]"}], ":=", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"B", "=", 
         RowBox[{
          RowBox[{"Bend3", "[", 
           RowBox[{
           "V", ",", "n", ",", " ", "cocluster", ",", " ", "cluster", ",", 
            " ", "Integers"}], "]"}], "[", "i", "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "B", "]"}], ">", "0"}], ",", " ", 
         RowBox[{"(*", 
          RowBox[{
          "*", " ", "IF", " ", "the", " ", "system", " ", "of", " ", 
           "equations", " ", "has", " ", "integer", " ", "solutions"}], " ", 
          "**)"}], " ", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"B", ",", "\"\<integral\>\""}], "}"}], ",", " ", 
         RowBox[{"(*", 
          RowBox[{
          "*", " ", "THEN", " ", "return", " ", "the", " ", "bend", " ", 
           "matrix", " ", "and", " ", "\"\<integral\>\""}], " ", "**)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Bend3", "[", 
             RowBox[{
             "V", ",", "n", ",", " ", "cocluster", ",", " ", "cluster", ",", 
              " ", "Reals"}], "]"}], "[", "i", "]"}], ",", 
           "\"\<nonintegral\>\""}], "}"}]}], " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"*", " ", "Otherwise"}], ",", " ", 
          RowBox[{
          "find", " ", "the", " ", "real", " ", "solutions", " ", "and", " ", 
           "return", " ", "\"\<nonintegral\>\""}]}], " ", "**)"}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"bends", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CheckCluster", "[", "List_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"adlist", ",", " ", "adlist2", ",", " ", "intersectionlist"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", " ", 
         RowBox[{"i", "<", 
          RowBox[{"Length", "[", "List", "]"}]}], ",", " ", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "*", " ", "For", " ", "every", " ", "circle", " ", "in", " ", "the",
            " ", "cluster"}], " ", "**)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "*", " ", "get", " ", "the", " ", "vertices", " ", "adjacent", " ", 
           "to", " ", "it"}], " ", "**)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"adlist", "=", 
           RowBox[{"Lookup", "[", 
            RowBox[{"AdjDict", ",", " ", 
             RowBox[{"List", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "*", " ", "Now", " ", "for", " ", "every", " ", "other", " ", 
             "vertex"}], ",", " ", 
            RowBox[{
            "also", " ", "get", " ", "the", " ", "adjacency", " ", "list"}]}],
            " ", "**)"}], "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", " ", 
            RowBox[{"j", "<", 
             RowBox[{"Length", "[", "AllVerts", "]"}]}], ",", " ", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"adlist2", "=", 
              RowBox[{"Lookup", "[", 
               RowBox[{"AdjDict", ",", " ", 
                RowBox[{"AllVerts", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"intersectionlist", "=", 
              RowBox[{"Intersection", "[", 
               RowBox[{"adlist", ",", " ", "adlist2"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Cond1", "=", 
              RowBox[{
               RowBox[{"Length", "[", "intersectionlist", "]"}], 
               "\[NotEqual]", "0"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Cond2", "=", 
              RowBox[{
               RowBox[{"AllVerts", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", 
               RowBox[{"List", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "*", " ", "If", " ", "the", " ", "circle", " ", "vertex", " ", 
               "shares", " ", "a", " ", "crossing", " ", "vertex", " ", 
               "with", " ", "another", " ", "vertex"}], " ", "**)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
              "*", " ", "Check", " ", "if", " ", "the", " ", "second", " ", 
               "vertex", " ", "is", " ", "original"}], " ", "**)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Cond1", "&&", "Cond2"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"OrigList", ",", " ", 
                    RowBox[{"AllVerts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "*", " ", "Check", " ", "if", " ", "there", " ", "is", " ",
                     "a", " ", "1", " ", "in", " ", "the", " ", "Gram", "  ", 
                    "matrix"}], " ", "**)"}], "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"GramMatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"(*", "*", " ", "**)"}], " ", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"ICVPlace2Vert", ",", " ", 
                    RowBox[{"AllVerts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], " ", 
                    RowBox[{"(*", "*", " ", "**)"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"(*", "*", " ", "**)"}], " ", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"ICVPlace2Vert", ",", " ", 
                    RowBox[{"OrigList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], " ", 
                    RowBox[{"(*", "*", " ", "**)"}], "]"}], "]"}], 
                    "\[NotEqual]", "1"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"CheckingIfGramIsCorrect", ",", " ", "5"}], 
                    "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "*", " ", "Check", " ", "if", " ", "the", " ", "second", " ",
                   "vertex", " ", "is", " ", "dual"}], " ", "**)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MemberQ", "[", 
                   RowBox[{"DualList", ",", " ", 
                    RowBox[{"AllVerts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                   "*", " ", "Check", " ", "if", " ", "there", " ", "is", " ",
                     "a", " ", "0", " ", "in", " ", "the", " ", "Gram", " ", 
                    "matrix"}], " ", "**)"}], "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"GramMatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"(*", "*", " ", "**)"}], " ", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"ICVPlace2Vert", ",", " ", 
                    RowBox[{"AllVerts", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], 
                    RowBox[{"(*", "*", " ", "**)"}], "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"(*", "*", " ", "**)"}], 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"ICVPlace2Vert", ",", " ", 
                    RowBox[{"OrigList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], 
                    RowBox[{"(*", "*", " ", "**)"}], "]"}], "]"}], 
                    "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"CheckingIfGramIsCorrect", ",", " ", "5"}], 
                    "]"}]}], "]"}]}], "]"}]}]}], "]"}]}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CheckGram", "[", 
      RowBox[{"OrigList_", ",", " ", "DualList_", ",", " ", "Matrix_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CheckingIfGramIsCorrect", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"CheckCluster", "[", "OrigList", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", " ", 
          RowBox[{"i", "<", 
           RowBox[{"Length", "[", "InvCoordVec", "]"}]}], ",", " ", 
          RowBox[{"i", "++"}], ",", " ", 
          RowBox[{
           RowBox[{"num", "=", 
            RowBox[{"FullSimplify", "[", 
             RowBox[{
              RowBox[{"GramMatrix", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"num", "!=", 
              RowBox[{"-", "1"}]}], ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"CheckingIfGramIsCorrect", ",", "7"}], "]"}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Length", "[", "CheckingIfGramIsCorrect", "]"}], "\[Equal]", 
         "0"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Everything", "[", 
      RowBox[{"InvCoordVec_", ",", " ", "DualList_", ",", " ", "OrigList_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"GramMatrix", "=", 
           RowBox[{"Gram", "[", "InvCoordVec", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"a", "=", 
           RowBox[{"CheckGram", "[", 
            RowBox[{
            "OrigList", ",", " ", "DualList", ",", " ", "GramMatrix"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Gram matrix is verified, \>\"", ",", " ", "a"}], 
           "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Everything", "[", 
     RowBox[{"InvCoordVec", ",", " ", "DualList", ",", " ", "OrigList"}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{"a", ",", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"MatrixForm", "[", "GramMatrix", "]"}], "]"}], ";", " ", 
       RowBox[{"bends", "=", 
        RowBox[{
         RowBox[{"Bend4", "[", 
          RowBox[{"Vout", ",", " ", 
           RowBox[{"Length", "[", "OrigList", "]"}]}], "]"}], "/@", 
         RowBox[{"Range", "@", 
          RowBox[{"Length", "[", "DualList", "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "bends", "]"}], ";", " ", 
       RowBox[{"Render", "[", 
        RowBox[{"DualList", ",", " ", "OrigList"}], "]"}]}]}], "]"}]}], ",", 
   " ", "500"}], "]"}]], "Input",
 CellChangeTimes->{{3.8053848092498703`*^9, 
  3.8053848345317607`*^9}},ExpressionUUID->"53f9c51e-47e9-433f-b8d9-\
450ab9964fcc"]
},
WindowSize->{1350, 669},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 9, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a4fc3a7e-657c-47a0-8875-71f2ec68fd65"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 129132, 2903, 9444, "Input",ExpressionUUID->"53f9c51e-47e9-433f-b8d9-450ab9964fcc"]
}
]
*)

